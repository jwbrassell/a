<!-- Column Transform Modal -->
<div class="modal fade" id="transformModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Configure Transform: <span id="transformColumnName"></span></h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <!-- Left side: Configuration -->
                    <div class="col-md-8">
                        <input type="hidden" id="transformColumnIndex">
                        <div class="form-group">
                            <label>Transform Type</label>
                            <select class="form-control" id="transformType">
                                <option value="">None</option>
                                <option value="url">URL Link</option>
                                <option value="date">Date Format</option>
                                <option value="number">Number Format</option>
                                <option value="boolean">Boolean</option>
                                <option value="python">Python Expression</option>
                                <option value="regex">Regular Expression</option>
                                <option value="custom">Custom JavaScript</option>
                            </select>
                        </div>
                        
                        <div class="form-check mb-3">
                            <input type="checkbox" class="form-check-input" id="serverSide">
                            <label class="form-check-label" for="serverSide">
                                Process on Server Side
                            </label>
                        </div>

                        <!-- Transform Type Specific Configurations -->
                        <div id="transformConfigs">
                            <!-- URL Configuration -->
                            <div id="urlConfig" class="transform-config" style="display: none;">
                                <div class="form-group">
                                    <label>URL Template</label>
                                    <input type="text" class="form-control transform-input" id="urlTemplate" 
                                           placeholder="https://example.com/{value}">
                                </div>
                                <div class="form-group">
                                    <label>Link Text Template</label>
                                    <input type="text" class="form-control transform-input" id="urlText" 
                                           placeholder="View {value}">
                                </div>
                            </div>

                            <!-- Date Configuration -->
                            <div id="dateConfig" class="transform-config" style="display: none;">
                                <div class="form-group">
                                    <label>Date Format</label>
                                    <input type="text" class="form-control transform-input" id="dateFormat" 
                                           placeholder="YYYY-MM-DD HH:mm:ss">
                                </div>
                            </div>

                            <!-- Number Configuration -->
                            <div id="numberConfig" class="transform-config" style="display: none;">
                                <div class="form-group">
                                    <label>Decimal Places</label>
                                    <input type="number" class="form-control transform-input" id="decimalPlaces" min="0" max="10">
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input transform-input" id="useThousandsSeparator">
                                    <label class="form-check-label">Use Thousands Separator</label>
                                </div>
                                <div class="form-group">
                                    <label>Prefix</label>
                                    <input type="text" class="form-control transform-input" id="numberPrefix" placeholder="$">
                                </div>
                                <div class="form-group">
                                    <label>Suffix</label>
                                    <input type="text" class="form-control transform-input" id="numberSuffix" placeholder="%">
                                </div>
                            </div>

                            <!-- Boolean Configuration -->
                            <div id="booleanConfig" class="transform-config" style="display: none;">
                                <div class="form-group">
                                    <label>True Display</label>
                                    <input type="text" class="form-control transform-input" id="trueDisplay" placeholder="Yes">
                                </div>
                                <div class="form-group">
                                    <label>False Display</label>
                                    <input type="text" class="form-control transform-input" id="falseDisplay" placeholder="No">
                                </div>
                            </div>

                            <!-- Python Configuration -->
                            <div id="pythonConfig" class="transform-config" style="display: none;">
                                <div class="form-group">
                                    <label>Python Expression</label>
                                    <textarea class="form-control transform-input" id="pythonExpression" rows="3"
                                            placeholder="value.upper() if isinstance(value, str) else value"></textarea>
                                </div>
                            </div>

                            <!-- Regex Configuration -->
                            <div id="regexConfig" class="transform-config" style="display: none;">
                                <div class="form-group">
                                    <label>Pattern</label>
                                    <input type="text" class="form-control transform-input" id="regexPattern" 
                                           placeholder="(\w+)@(\w+\.\w+)">
                                </div>
                                <div class="form-group">
                                    <label>Operation</label>
                                    <select class="form-control transform-input" id="regexOperation">
                                        <option value="replace">Replace</option>
                                        <option value="match">Match Only</option>
                                        <option value="extract">Extract Group</option>
                                    </select>
                                </div>
                                <div id="regexReplaceConfig">
                                    <div class="form-group">
                                        <label>Replacement</label>
                                        <input type="text" class="form-control transform-input" id="regexReplacement" 
                                               placeholder="[$1]@$2">
                                    </div>
                                </div>
                                <div id="regexExtractConfig" style="display: none;">
                                    <div class="form-group">
                                        <label>Group Number</label>
                                        <input type="number" class="form-control transform-input" id="regexGroup" 
                                               min="0" value="0">
                                    </div>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input transform-input" id="regexCaseInsensitive">
                                    <label class="form-check-label">Case Insensitive</label>
                                </div>
                                <div class="form-check">
                                    <input type="checkbox" class="form-check-input transform-input" id="regexMultiline">
                                    <label class="form-check-label">Multiline</label>
                                </div>
                            </div>

                            <!-- Custom JavaScript Configuration -->
                            <div id="customConfig" class="transform-config" style="display: none;">
                                <div class="form-group">
                                    <label>Custom JavaScript</label>
                                    <textarea class="form-control transform-input" id="customTransform" rows="3"
                                            placeholder="return value.toUpperCase();"></textarea>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Right side: Live Preview -->
                    <div class="col-md-4">
                        <div class="card">
                            <div class="card-header">
                                <h5 class="card-title">Transform Preview</h5>
                            </div>
                            <div class="card-body">
                                <div class="form-group">
                                    <label>Sample Input</label>
                                    <input type="text" class="form-control" id="transformPreviewInput">
                                </div>
                                <div class="form-group">
                                    <label>Preview Output</label>
                                    <div id="transformPreviewOutput" class="border p-2 bg-light">
                                        <!-- Preview will be shown here -->
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" id="saveTransform">Save</button>
            </div>
        </div>
    </div>
</div>
