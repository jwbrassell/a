{% extends 'base.html' %}

{% block title %}Create Project{% endblock %}

{% block breadcrumb %}
<ol class="breadcrumb float-sm-right">
    <li class="breadcrumb-item"><a href="{{ url_for('main.index') }}">Home</a></li>
    <li class="breadcrumb-item"><a href="{{ url_for('projects.index') }}">Projects</a></li>
    <li class="breadcrumb-item active">Create Project</li>
</ol>
{% endblock %}

{% block page_content %}
<div class="container-fluid">
    <!-- Page header -->
    <div class="row mb-4">
        <div class="col-sm-6">
            <h1 class="m-0">Create Project</h1>
        </div>
    </div>

    <!-- Project creation form -->
    <div class="card">
        <div class="card-body">
            <form method="POST">
                {{ form.hidden_tag() }}
                
                <!-- Basic Information -->
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            {{ form.name.label(class="form-label") }}
                            {{ form.name(class="form-control" + (" is-invalid" if form.name.errors else "")) }}
                            {% if form.name.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.name.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            {{ form.status.label(class="form-label") }}
                            {{ form.status(class="form-control" + (" is-invalid" if form.status.errors else "")) }}
                            {% if form.status.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.status.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    {{ form.description.label(class="form-label") }}
                    {{ form.description(class="form-control tinymce" + (" is-invalid" if form.description.errors else "")) }}
                    {% if form.description.errors %}
                        <div class="invalid-feedback">
                            {% for error in form.description.errors %}
                                {{ error }}
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Project Settings -->
                <h4 class="mt-4">Project Settings</h4>
                <div class="row">
                    <div class="col-md-6">
                        <div class="form-group">
                            {{ form.priority.label(class="form-label") }}
                            {{ form.priority(class="form-control" + (" is-invalid" if form.priority.errors else "")) }}
                            {% if form.priority.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.priority.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="form-group">
                            {{ form.percent_complete.label(class="form-label") }}
                            {{ form.percent_complete(class="form-control" + (" is-invalid" if form.percent_complete.errors else ""), type="number", min="0", max="100") }}
                            {% if form.percent_complete.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.percent_complete.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Project Roles -->
                <h4 class="mt-4">Project Roles</h4>
                <div class="row">
                    <!-- Project Lead -->
                    <div class="col-md-6">
                        <div class="form-group">
                            {{ form.lead_id.label(class="form-label") }}
                            {{ form.lead_id(class="form-control select2" + (" is-invalid" if form.lead_id.errors else "")) }}
                            {% if form.lead_id.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.lead_id.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Team Members -->
                    <div class="col-md-6">
                        <div class="form-group">
                            {{ form.team_members.label(class="form-label") }}
                            {{ form.team_members(class="form-control select2" + (" is-invalid" if form.team_members.errors else "")) }}
                            {% if form.team_members.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.team_members.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <div class="row">
                    <!-- Watchers -->
                    <div class="col-md-4">
                        <div class="form-group">
                            {{ form.watchers.label(class="form-label") }}
                            {{ form.watchers(class="form-control select2" + (" is-invalid" if form.watchers.errors else "")) }}
                            {% if form.watchers.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.watchers.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Stakeholders -->
                    <div class="col-md-4">
                        <div class="form-group">
                            {{ form.stakeholders.label(class="form-label") }}
                            {{ form.stakeholders(class="form-control select2" + (" is-invalid" if form.stakeholders.errors else "")) }}
                            {% if form.stakeholders.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.stakeholders.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Shareholders -->
                    <div class="col-md-4">
                        <div class="form-group">
                            {{ form.shareholders.label(class="form-label") }}
                            {{ form.shareholders(class="form-control select2" + (" is-invalid" if form.shareholders.errors else "")) }}
                            {% if form.shareholders.errors %}
                                <div class="invalid-feedback">
                                    {% for error in form.shareholders.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Form Actions -->
                <div class="row mt-4">
                    <div class="col-12">
                        <a href="{{ url_for('projects.index') }}" class="btn btn-secondary">Cancel</a>
                        <button type="submit" class="btn btn-primary float-right">Create Project</button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
$(document).ready(function() {
    // Initialize Select2 for all select fields
    $('.select2').select2({
        theme: 'bootstrap4',
        width: '100%'
    });

    // Initialize TinyMCE for description
    tinymce.init({
        selector: '.tinymce',
        height: 300,
        menubar: false,
        plugins: [
            'advlist autolink lists link image charmap print preview anchor',
            'searchreplace visualblocks code fullscreen',
            'insertdatetime media table paste code help wordcount'
        ],
        toolbar: 'undo redo | formatselect | bold italic backcolor | \
                alignleft aligncenter alignright alignjustify | \
                bullist numlist outdent indent | removeformat | help'
    });
});
</script>
{% endblock %}
